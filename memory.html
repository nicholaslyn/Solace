<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Saved Memories</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- Nav -->
    <div>
      <button onclick="location.href='index.html'">Journal</button>
      <button onclick="location.href='therapist.html'">AI Companion</button>
      <button onclick="location.href='memory.html'">Saved Memories</button>
    </div>

    <h1>üóÇÔ∏è Saved Memories</h1>
    <div>
      <button onclick="exportMemories()">Export (.json)</button>
      <button onclick="clearMemories()">Clear Memories</button>
    </div>

    <div id="entries"></div>
  </div>

  <script>
    function escapeHtml(s){ return String(s).replace(/[&<>"]/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[c])); }
    function load(){
      const list = JSON.parse(localStorage.getItem("memoryEntries")||"[]");
      const c = document.getElementById("entries");
      c.innerHTML = "";
      list.forEach((e,i)=>{
        const div = document.createElement("div");
        div.className = "entry";
        div.innerHTML = `<p>${escapeHtml(e.text).replace(/\n/g,"<br>")}</p>
                         <small>${e.timestamp}</small>
                         <div><button onclick="delMem(${i})">üóëÔ∏è Delete</button></div>`;
        c.appendChild(div);
      });
      if (!list.length) c.innerHTML = `<div class="entry"><em>No memories yet.</em></div>`;
    }
    function delMem(i){
      const list = JSON.parse(localStorage.getItem("memoryEntries")||"[]");
      list.splice(i,1);
      localStorage.setItem("memoryEntries", JSON.stringify(list));
      load();
    }
    function clearMemories(){
      if (!confirm("Clear ALL saved memories?")) return;
      localStorage.removeItem("memoryEntries");
      load();
    }
    function exportMemories(){
      const data = localStorage.getItem("memoryEntries") || "[]";
      const blob = new Blob([data], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "journal-memories.json";
      a.click(); URL.revokeObjectURL(a.href);
    }
    document.addEventListener("DOMContentLoaded", load);
  </script>
</body>
</html>

