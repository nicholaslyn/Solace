<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Personal Journal</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- Nav (uses your button style) -->
    <div>
      <button onclick="location.href='index.html'">Journal</button>
      <button onclick="location.href='therapist.html'">AI Companion</button>
      <button onclick="location.href='memory.html'">Saved Memories</button>
    </div>

    <h1>üåü Daily Journal üåü</h1>

    <textarea id="journalEntry" placeholder="Write your thoughts here..."></textarea>

    <div>
      <button onclick="saveEntry()">Save Entry</button>
      <button onclick="saveToMemory()">Save to Memory</button>
      <button onclick="clearEntries()">Clear Entries</button>
      <button onclick="exportEntries()">Export (.json)</button>
    </div>

    <h2>üìñ Past Entries</h2>
    <div id="entries"></div>
  </div>

  <script>
    function escapeHtml(s){ return String(s).replace(/[&<>"]/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[c])); }

    function loadEntries(){
      const list = JSON.parse(localStorage.getItem("journalEntries")||"[]");
      const c = document.getElementById("entries");
      c.innerHTML = "";
      list.forEach((e,i)=>{
        const div = document.createElement("div");
        div.className = "entry";
        div.innerHTML = `<p>${escapeHtml(e.text).replace(/\n/g,"<br>")}</p>
                         <small>${e.timestamp}</small>
                         <div><button onclick="delEntry(${i})">üóëÔ∏è Delete</button></div>`;
        c.appendChild(div);
      });
      if (!list.length) c.innerHTML = `<div class="entry"><em>No entries yet.</em></div>`;
    }
    function saveEntry(){
      const t = document.getElementById("journalEntry").value;
      if (!t.trim()) return;
      const list = JSON.parse(localStorage.getItem("journalEntries")||"[]");
      list.unshift({ text:t, timestamp:new Date().toLocaleString() });
      localStorage.setItem("journalEntries", JSON.stringify(list));
      document.getElementById("journalEntry").value = "";
      loadEntries();
    }
    function delEntry(i){
      const list = JSON.parse(localStorage.getItem("journalEntries")||"[]");
      list.splice(i,1);
      localStorage.setItem("journalEntries", JSON.stringify(list));
      loadEntries();
    }
    function saveToMemory(){
      const cur = JSON.parse(localStorage.getItem("journalEntries")||"[]");
      const mem = JSON.parse(localStorage.getItem("memoryEntries")||"[]");
      localStorage.setItem("memoryEntries", JSON.stringify(cur.concat(mem)));
      localStorage.removeItem("journalEntries");
      loadEntries();
    }
    function clearEntries(){
      if (!confirm("Clear ALL current entries?")) return;
      localStorage.removeItem("journalEntries");
      loadEntries();
    }
    function exportEntries(){
      const data = localStorage.getItem("journalEntries") || "[]";
      const blob = new Blob([data], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "journal-entries.json";
      a.click(); URL.revokeObjectURL(a.href);
    }
    document.addEventListener("DOMContentLoaded", loadEntries);
  </script>
</body>
</html>

